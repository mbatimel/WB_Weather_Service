# Документация по проекту WB Weather Service

## Содержание
1. [Введение](#введение)
2. [Структура проекта](#структура-проекта)
3. [Зависимости](#зависимости)
4. [Сборка и запуск сервиса](#сборка-и-запуск-сервиса)
5. [API Эндпоинты](#api-эндпоинты)
6. [Примеры запросов](#примеры-запросов)

## Введение

WB Weather Service — это сервис для получения и обновления прогноза погоды для различных городов. Сервис взаимодействует с базой данных PostgreSQL и внешним API OpenWeather для получения данных о погоде.

## Структура проекта

Проект состоит из следующих основных частей:

- **Docker**: Используется для контейнеризации приложения и базы данных.
- **Go**: Основной язык программирования для разработки сервиса.
- **PostgreSQL**: База данных для хранения информации о городах и погодных прогнозах.
- **API**: Эндпоинты для взаимодействия с клиентами.

## Зависимости

Для запуска проекта необходимы следующие зависимости:

- Docker и Docker Compose
- Golang
- PostgreSQL

## Сборка и запуск сервиса

### Шаг 1: Клонирование репозитория

Сначала клонируйте репозиторий с проектом:

```bash
git clone https://github.com/mbatimel/WB_Weather_Service.git
cd WB_Weather_Service
```

### Шаг 2: Создание файла конфигурации

Создайте файл `config/config.yaml` с содержимым:

```yaml
server:
  host: "localhost"
  port: "8080"

repo:
    database: WB_developer
    user: mbatimel
    password: wb_il
    host: "localhost"
    port: "5432"
```

### Шаг 3: Запуск с использованием Docker

Запустите сервис с использованием Docker Compose:

```bash
docker-compose up --build
```

Docker Compose создаст и запустит два контейнера:
- `postgres`: Контейнер с базой данных PostgreSQL.
- `app`: Контейнер с приложением на Go.

### Шаг 4: Применение миграций

После запуска контейнеров примените миграции для базы данных:

```bash
docker-compose exec app ./migration
```

## API Эндпоинты

### Получение всех городов

**URL**: `/allCyties`

**Метод**: GET

**Описание**: Возвращает список всех городов.

**Пример ответа**:

```json
[
  "Berlin",
  "London",
  "New York",
  "Paris",
  "Tokyo"
]
```

### Краткая информация о городе

**URL**: `/hortInfoCity?city={cityName}`

**Метод**: GET

**Параметры**:
- `city`: Название города.

**Описание**: Возвращает краткую информацию о городе, включая среднюю температуру и доступные даты прогноза.

**Пример запроса**:

```http
GET /hortInfoCity?city=London
```

**Пример ответа**:

```json
{
  "country": "GB",
  "city": "London",
  "avg_temp": 15.5,
  "available_dates": [
    "2024-07-10",
    "2024-07-11",
    "2024-07-12"
  ]
}
```

### Полная информация о погоде в городе

**URL**: `/fullInfoCity?city={cityName}&date={date}`

**Метод**: GET

**Параметры**:
- `city`: Название города.
- `date`: Дата прогноза в формате `YYYY-MM-DD`.

**Описание**: Возвращает полную информацию о погоде в указанном городе на указанную дату.

**Пример запроса**:

```http
GET /fullInfoCity?city=London&date=2024-07-10
```

**Пример ответа**:

```json
{
  "country": "GB",
  "city": "London",
  "date": "2024-07-10T00:00:00Z",
  "temp": 15.5,
  "weather_data": {
    "main": {
      "temp": 15.5,
      "feels_like": 14.8,
      "temp_min": 14.0,
      "temp_max": 17.0,
      "pressure": 1012,
      "humidity": 82
    },
    "weather": [
      {
        "description": "облачно",
        "icon": "04d"
      }
    ]
  }
}
```
### Добавление пользователя
**URL**: `/addNewUser?person={username}&password={pswd}`

**Метод**: ADD

**Параметры**:
- `person`: Инкнейм пользователя в системе.
- `password`: Пароль(хэшируется).

**Описание**: Добавляет пользователя в базу данных

**Пример запроса**:

```http
ADD /addNewUser?person=Mbatimel&password=1234
```

**Пример ответа**:

```json
"User created successfully"
```
### Добавление города в избранные у пользователя
**URL**: `/addCityToFuvorites?person={username}&password={pswd}&city={city}`

**Метод**: ADD

**Параметры**:
- `city`: Название города.
- `person`: Инкнейм пользователя в системе.
- `password`: Пароль(хэшируется).

**Описание**: Добавляет город в избранные у пользователя.

**Пример запроса**:

```http
ADD /addCityToFuvorites?person=Mbatimel&password=1234&city=Berlin
```

**Пример ответа**:

```json
"Added successfully"
```
### Полная информация об избранных городах
**URL**: `/favoritCityInfo?person={username}&password={pswd}`

**Метод**: GET

**Параметры**:
- `person`: Инкнейм пользователя в системе.
- `password`: Пароль(хэшируется).

**Описание**: Возвращает полную информацию по городам, которые находятся в избранных у пользователя

**Пример запроса**:

```http
GET /favoritCityInfo?person=Mbatimel&password=1234
```

**Пример ответа**:

```json

```
# КОНЕЦ!!! А КТО ЧИТАЛ, МОЛОДЕЦ!!!!